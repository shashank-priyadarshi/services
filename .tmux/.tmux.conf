# enable tmux plugin manager
set -g @plugin 'tmux-plugins/tpm'
# use tmux status bar powerline
#  set -g @plugin 'erikw/tmux-powerline'
# plugin for improved copy/paste behavior
set -g @plugin 'tmux-plugins/tmux-yank'
# plugin for saving and restoring tmux sessions
set -g @plugin 'tmux-plugins/tmux-resurrect'
# catppuccin theme
set -g @plugin 'catppuccin/tmux'
# sidebar with filetree
set -g @plugin 'tmux-plugins/tmux-sidebar'
# auto-save tmux sessions
set -g @plugin 'tmux-plugins/tmux-continuum'
# quickly open urls
# set -g @plugin 'tmux-plugins/tmux-urlview'
# fuzzy search sessions, windows, and panes
set -g @plugin 'roosta/tmux-fuzzback'
# System info plugins
set -g @plugin 'tmux-plugins/tmux-battery'
set -g @plugin 'thewtex/tmux-mem-cpu-load'
set -g @plugin 'tmux-plugins/tmux-cpu'
# set -g @plugin 'tmux-plugins/tmux-mem'

set -g @plugin 'jaclu/tmux-menus'
set -g @plugin 'thepante/tmux-git-autofetch'
set -g @plugin 'laktak/tome'
set -g @plugin 'laktak/extrakto'

# require pressing "y" to copy mouse selection
set -g @yank_with_mouse off

# remap prefix from 'C-b' to 'C-a'
unbind C-b
set-option -g prefix C-a
bind-key C-a send-prefix

# Enable mouse control (clickable windows, panes, resizable panes)
set-option -g mouse on

# split panes using | and -
bind | split-window -h
bind - split-window -v
unbind '"'
unbind %

# switch panes using Alt-arrow without prefix
bind -n M-Left select-pane -L
bind -n M-Right select-pane -R
bind -n M-Up select-pane -U
bind -n M-Down select-pane -D

set -g default-terminal "xterm-256color"
set -ga terminal-overrides ",xterm-256color:Tc"
set-option -g base-index 1
set-window-option -g pane-base-index 1

# reload config file (change file location to your the tmux.conf you want to use)
bind r source-file ~/.tmux.conf \; display "Reloaded!"

# DESIGN TWEAKS

# don't do anything when a 'bell' rings
set -g visual-activity off
set -g visual-bell off
set -g visual-silence off
setw -g monitor-activity off
set -g bell-action none

# clock mode
setw -g clock-mode-colour yellow

# copy mode
setw -g mode-style 'fg=black bg=red bold'

# panes - Keep these if you want to override catppuccin's pane borders
set -g pane-border-style 'fg=red'
set -g pane-active-border-style 'fg=yellow'

# statusbar
set -g status-position bottom
set -g status-justify left

# Let Catppuccin handle the colors, but define the format explicitly.
# #I: index, #W: window name, #F: flags (e.g., *, -)
# IMPORTANT: tmux will try to automatically name windows based on the running process.
# To prevent your shell's current directory from becoming the window name,
# ensure 'set-option -g allow-rename off' is active (which you have).
# You can also manually set window names using prefix + , (comma) or in your .bashrc.

# Status Right: System info and Time (adjusted for conciseness)
# Using a shorter date/time format to ensure it fits better.
# set -g status-right '#{prefix_highlight} | CPU: #{cpu_percentage} | Mem: #{mem_percentage} | #{battery_status_bg} #{battery_icon} #{battery_percentage} | %H:%M %d-%b-%y '
set -g status-left-length 50
set -g status-left '#(cd #{pane_current_path} && git rev-parse --abbrev-ref HEAD 2>/dev/null || echo "no-git") '

set -g status-interval 2
set -g status-right '#[fg=green]#(tmux-mem-cpu-load/tmux-mem-cpu-load --colors --powerline-right --interval 2)#[default] | C:#{cpu_percentage} | %H:%M %d-%b'

# messages - Keep if you want this specific color for messages
# set -g message-style 'fg=yellow bg=red bold'

# Initialize TMUX plugin manager (keep this line at the very bottom)
run '~/.tmux/plugins/tpm/tpm'

# Current window status format
# This will show the window index, window name, and flags (e.g., * for current)
# setw -g window-status-current-format ' #I #W #F '

# Non-current window status format
# setw -g window-status-format ' #I #W #F '

# Status Left: (Empty, or Catppuccin's default if it has one)
# Removing `set -g status-left` line as requested.

# don't rename windows automatically - IMPORTANT for managing window names
set-option -g allow-rename on
set-option -g automatic-rename off
set-window-option -g automatic-rename off

# Override tmux's default formatting for windows
set -g status-justify centre
set -g window-status-format ''
set -g window-status-current-format ''
set-window-option -g window-status-format ''
set-window-option -g window-status-current-format ''

bind-key , command-prompt "rename-window %%"

run-shell ~/.tmux/plugins/tmux-sidebar/sidebar.tmux
run-shell ~/.tmux/plugins/tmux-menus/menus.tmux
#run-shell ~/.tmux/plugins/tome/tome.tmux
run-shell ~/.tmux/plugins/extrakto/extrakto.tmux

set -g @git-autofetch-skip-paths ".*"
set -g @git-autofetch-scan-paths "~/go/src/"
set -g @git-autofetch-frequency "1"
set -g @git-autofetch-logging "true"

#set -g @tome_key "T-V"
#set -g @tome_scratch_key "T-S"
#set -g @tome_editor "nano"

set -g @extrakto_grab_area "full"
set -g @extrakto_filter_order "all"
